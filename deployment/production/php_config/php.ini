# Laravel 9 生產環境 PHP 配置
memory_limit = 1G
max_execution_time = 120
max_input_time = 120
post_max_size = 50M
upload_max_filesize = 50M
max_file_uploads = 20

# 錯誤報告 (生產環境)
display_errors = Off
display_startup_errors = Off
log_errors = On
error_log = /var/log/php_errors.log

# 時區設定
date.timezone = Asia/Taipei

# Session 設定
session.gc_maxlifetime = 7200
session.cookie_lifetime = 0

# OPcache 設定 (生產環境優化)
opcache.enable = 1
opcache.enable_cli = 1
opcache.memory_consumption = 256
opcache.interned_strings_buffer = 16
opcache.max_accelerated_files = 8000
opcache.revalidate_freq = 0
opcache.validate_timestamps = 0
opcache.fast_shutdown = 1
opcache.save_comments = 0
opcache.optimization_level = 0x7FFFBFFF

; ===== JIT 配置 =====
; 啟用 JIT 並設定緩衝區大小 (128MB)
opcache.jit_buffer_size=128M
; JIT 模式：tracing 模式，適合 Web 應用程式
opcache.jit=tracing
; JIT 熱點函數閾值
opcache.jit_hot_func=127
opcache.jit_hot_loop=64

; ===== 效能優化設定 =====
; 減少不必要的系統呼叫
opcache.use_cwd=1
opcache.validate_permission=0
opcache.validate_root=0

# 其他優化
realpath_cache_size = 4096K
realpath_cache_ttl = 600
expose_php = Off
